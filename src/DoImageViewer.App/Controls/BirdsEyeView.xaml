<UserControl
    x:Class="DoImageViewer.App.Controls.BirdsEyeView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:DoImageViewer.App.Controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    d:DesignHeight="200"
    d:DesignWidth="200"
    Background="Green"
    mc:Ignorable="d">
    <Border
        Background="#19000000"
        BorderBrush="Red"
        BorderThickness="1"
        ClipToBounds="True"
        CornerRadius="10">
        <Grid>
            <!--  标题栏  -->
            <TextBlock
                Margin="4,2"
                Padding="2"
                HorizontalAlignment="Left"
                VerticalAlignment="Top"
                FontSize="10"
                Foreground="White"
                Text="鸟瞰图" />

            <!--  缩略图显示区域  -->
            <Canvas
                x:Name="ThumbnailCanvas"
                Margin="0,20,0,10"
                ClipToBounds="True"
                MouseEnter="OnCanvasMouseEnter"
                MouseLeave="OnCanvasMouseLeave"
                MouseLeftButtonDown="OnCanvasMouseLeftButtonDown"
                MouseLeftButtonUp="OnCanvasMouseLeftButtonUp"
                MouseMove="OnCanvasMouseMove"
                Opacity="1">

                <!--  缩略图图片  -->
                <Image
                    x:Name="ThumbnailImage"
                    RenderOptions.BitmapScalingMode="HighQuality"
                    Stretch="Uniform" />

                <!--  遮罩层 - 使视口外区域变暗  -->
                <Path
                    x:Name="DarkMask"
                    Fill="#80000000"
                    Visibility="Collapsed">
                    <Path.Data>
                        <CombinedGeometry x:Name="MaskGeometry" GeometryCombineMode="Exclude">
                            <CombinedGeometry.Geometry1>
                                <RectangleGeometry x:Name="FullAreaGeometry" />
                            </CombinedGeometry.Geometry1>
                            <CombinedGeometry.Geometry2>
                                <RectangleGeometry x:Name="ViewportGeometry" />
                            </CombinedGeometry.Geometry2>
                        </CombinedGeometry>
                    </Path.Data>
                </Path>

                <!--  视口指示器边框  -->
                <Rectangle
                    x:Name="ViewportIndicator"
                    Fill="Transparent"
                    StrokeThickness="2"
                    Visibility="Collapsed">
                    <Rectangle.Effect>
                        <DropShadowEffect
                            BlurRadius="3"
                            Opacity="0.3"
                            ShadowDepth="1"
                            Color="Black" />
                    </Rectangle.Effect>
                </Rectangle>
            </Canvas>
        </Grid>
    </Border>
</UserControl>